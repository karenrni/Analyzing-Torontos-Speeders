---
title: "Chasing Speed Demons: Analyzing Toronto’s Speeding Hotspots and Enforcement Gaps”"
subtitle: "My subtitle if needed"
author: 
  - Karen Riani
thanks: "Code and data are available at: https://github.com/karenrni/Analyzing-Torontos-Speeders/."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
toc: true
fig_caption: yes
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(arrow)
library(kableExtra)

final_filtered_data <- read_parquet("../data/analysis_data/analysis_data.parquet")


```
\newpage

# Introduction

Toronto's battle against speeding takes some wild turns—literally and figuratively. A speed camera notorious for issuing tens of thousands of tickets on Parkside Drive, Toronto's most ticketed street for speeding, was cut down less than 24 hours after being reinstalled [@toronto2023; @cbc2023]. While the city struggles to curb speeding, new research by the Canadian Automobile Association (CAA) paints a troubling picture: nearly 70% of Canadians admit to speeding in residential areas, 50% routinely speed on highways, and 20% regularly push well beyond the limit [@jobbernation2023].

The rise of advanced vehicle technology and the adrenaline appeal of street racing exacerbate these issues, with young male drivers (18–25 years) disproportionately represented in this trend. Though rare at **0.9% prevalence**, street racing poses a **five-fold increase in crash risk (OR = 5.23, p < .001)**, even after accounting for other risk factors [@simonsmorton2017]. Despite Ontario’s strict penalties, such as **$10,000 fines** and **30-day license suspensions for excessive speeding**, enforcement alone has not fully addressed these challenges [@trafficparalegal2024]. Recent headlines, such as a driver clocked at **102 km/h in a 50 km/h school zone** and a Toronto speed camera being destroyed less than 24 hours after reinstallation, underscore the disconnect between enforcement measures and public behavior [@citynews2024; @cbc2023].

This paper focuses on understanding the estimand **over_speed_limit**, the amount by which speeds in each observed speed bin exceed the posted speed limit. This dependent variable is calculated as the difference between the lower bound of the observed speed bin and the speed limit, ensuring a straightforward measure of speeding severity. By quantifying how far drivers exceed the limit, over_speed_limit allows for identifying patterns of high-risk speeding behaviour. Using open data from Toronto's School Safety Zone Watch Your Speed Program, Watch Your Speed Detailed Counts, and Traffic Camera datasets, including vehicle counts (volume) in each speed bin, speed limits, and ward-level identifiers, this study investigates how traffic patterns, enforcement mechanisms, and geographic factors contribute to variations in speeding behaviour across the city.

To address this, the study employs multi-linear regression models to examine the relationship between excess speed and predictors such as traffic volume, speed limits, and ward characteristics throughout 2023. Results indicate that higher traffic volume reduces excess speed by **0.12 km/h per additional vehicle**, while speed limits positively influence speeding by **0.13 km/h per unit increase**. Wards exhibit substantial variability, with some, such as Ward 4, showing significant decreases in speeding. However, the impact of individual speed cameras was negligible, suggesting limitations in the data and methodology for evaluating camera-specific effects.

The rest of this paper is structured as follows:  @sec-mydatasection presents the data sources and methodology, @sec-mymodel presents the forecasting model, then  @sec-myresults followed by  @sec-mydisc, which discusses the results and their implications.  @sec-mylimits concludes with a discussion of the limitations of the study and suggestions for future research, followed by Appendix @sec-ideal-surv with a budgeted idealized survey and methodology.



# Data {#sec-mydatasection}

## Overview
The data for this analysis is sourced from Open Data Toronto [@opendatatoronto] and comprises three datasets: School Safety Zone Watch Your Speed Program – Locations [@schoolzonelocations], School Safety Zone Watch Your Speed Program – Detailed Speed Counts in 2023 [@schoolzonespeeds], and the Traffic Camera dataset  [@trafficcameras]. These datasets provide detailed insights into speeding behavior, traffic enforcement mechanisms, and geographic characteristics within Toronto. The traffic camera and speed sign data were merged through a spacial join with a range of 500m using geographical coordinates. This was joined with the detailed counts of speeds through Toronto ward number (25 ward structure). 

## Packages Used
The analysis utilized R [@citeR] with the following packages: `opendatatoronto` [@opendatatoronto], `tidyverse` [@tidyverse], `janitor` [@janitor], `arrow` [@arrow], `readr` [@readr], `sf` [@sfpackage], `testthat` [@testthat], `ggplot2` [@ggplot2_wickham_2016], `corrplot` [@corrplot], `tidymodels` [@tidymodels], `kableExtra` [@kableExtra] and `rstanarm` [@rstanarm].

## Measurement 

The datasets from Open Data Toronto serve as the foundation for analyzing speeding behavior in Toronto. Each variable is derived from real-world phenomena and represents a specific aspect of traffic patterns or enforcement mechanisms:

- **Over Speed Limit**: This key dependent variable quantifies the extent to which drivers exceed posted speed limits. It is derived by calculating the difference between the midpoint of the observed speed bin (e.g., `[45,50)` translates to a midpoint of 47.5 km/h) and the posted speed limit. This method provides a nuanced measure of speeding severity, distinguishing between minor infractions and extreme violations.

- **Sign ID and Camera ID (X_id)**: These unique identifiers represent speed cameras and their locations, facilitating the mapping of speeding patterns to enforcement points. However, sign addresses may not always align precisely with camera placements, as discussed in the limitations section.

- **Longitude and Latitude**: Geographic coordinates capturing the locations of observed speeding behaviour, allowing for spatial analysis and the identification of high-risk zones.

- **Speed Limit**: The posted speed limits for each location, ranging from 30 km/h to 50 km/h, with an average of 38.24 km/h. This variable provides the baseline against which speeding is measured.

- **Volume**: The count of vehicles observed in a given speed bin, representing traffic density. Median volume is 13 vehicles, with counts ranging widely, up to a maximum of 209 vehicles. 

- **Speed Bin**: Recorded ranges of observed speeds, such as `[45,50)`, provide context for speed categories, assuming uniform speed distributions within each bin.

- **Ward Number**: Geographic zones represented as categorical identifiers, reflecting administrative boundaries within Toronto. For instance, Ward 10 accounts for 28.8% of observations, making it the most represented ward, while Ward 19 has considerably fewer observations.

- **No Camera in Radius**: This binary variable was constructed based on spatial joins between speed observation data and camera locations. If a given location fell outside the defined radius of nearby cameras, it was flagged as `TRUE`. This captures the absence of enforcement presence and allows for an analysis of its influence on speeding behavior.

- **Camera Density**: To represent enforcement intensity across wards, the number of cameras was aggregated per ward. This variable offers insight into how concentrated enforcement might correlate with traffic patterns or speeding violations.

## Data Limitations

The datasets used in this study have notable limitations that must be acknowledged. **Sign addresses** in the datasets have not been verified and may represent the address of an adjacent property rather than the actual location of the sign. The **speed limit** column reflects the most recent operating parameter, which does not necessarily align with the current or previous speed limits for each location.

The **Traffic Cameras** dataset is highly up-to-date, with a last refresh on 2024-11-26. While there are no issues with accessibility or completeness, usability is constrained by unclear column names and incomplete metadata. Conversely, the **School Safety Zone Watch Your Speed Program – Detailed Speed Counts** dataset is over 12 months outdated, requiring reliance on direct CSV links for access. This reduces its applicability for analysing current traffic trends.

To address gaps, **spatial joins** were employed to map camera locations to speed observation points, identifying enforcement presence, and **calculated variables**, such as over speed limit and camera density, were derived to facilitate analysis. However, these transformations have limitations. Speed bin ranges assume a uniform speed distribution, which may not capture the variability in driver behaviours. Furthermore, camera placements are concentrated in high-traffic or high-risk areas, potentially underrepresenting quieter zones. Together, these factors highlight the need for caution when interpreting results, as the datasets provide a snapshot rather than a comprehensive depiction of traffic behaviour.


## Descriptive Statistics
Descriptive statistics in [@tbl-summary] highlight critical patterns within the data:

- The **mean over speed limit** is 3.91 km/h, with extreme violations reaching up to 70 km/h.

- The **median speed bin midpoint** is 30 km/h, while the mean traffic volume is 23.35 vehicles.

- Geographic variables such as **longitude** and **latitude** center around Toronto’s urban core.


```{r}
#| label: tbl-summary
#| fig-cap: Summary of Joined Analysis Data
#| echo: false

# Prepare summary data
summary_data <- data.frame(
  Variable = c("sign_id", "X_id", "longitude", "latitude", 
               "speed_limit", "volume", "speed_bin_lower", "over_speed_limit"),
  Min = c(23, 11, -79.58, 43.64, 30, 1, 5, 0),
  "1st Qu." = c(667, 146, -79.40, 43.65, 40, 4, 15, 0),
  Median = c(950, 298, -79.36, 43.65, 40, 13, 30, 0),
  Mean = c(1105, 247.1, -79.36, 43.68, 38.24, 23.35, 30.23, 3.91),
  "3rd Qu." = c(978, 362, -79.33, 43.71, 40, 35, 40, 5),
  Max = c(2622, 423, -79.19, 43.79, 50, 209, 100, 70)
)

# Create a formatted table
summary_data %>%
  kbl(caption = "Summary Statistics for the Final Filtered Data") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), 
                full_width = FALSE, 
                position = "center") %>%
  column_spec(1, bold = TRUE, width = "10em") %>%
  row_spec(0, bold = TRUE)

```

```{r}
#| label: fig-heatbar
#| fig-cap: Number of Vehicles Exceeding Speed Limits by Ward
#| echo: false

# Summarize over speeding by ward
ward_speeding_summary <- final_filtered_data %>%
  group_by(ward_no) %>%
  summarize(
    total_over_speeding = sum(over_speed_limit > 0, na.rm = TRUE),
    avg_over_speeding = mean(over_speed_limit[over_speed_limit > 0], na.rm = TRUE)
  )

# Plot total over speeding by ward
ggplot(ward_speeding_summary, aes(x = factor(ward_no), y = total_over_speeding, fill = total_over_speeding)) +
  geom_col() +
  scale_fill_gradient(low = "yellow", high = "red") +
  labs(
    x = "Ward Number",
    y = "Total Over Speeding Incidents",
    fill = "Over Speeding Volume"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

```{r}
#| label: fig-cam-dens
#| fig-cap: Camera Density vs. Speeding Behavior
#| echo: false


### Explore camera density per ward
camera_density <- final_filtered_data %>%
  group_by(ward_no) %>%
  summarize(cameras_nearby = n_distinct(X_id), .groups = "drop")

ward_speed_analysis <- final_filtered_data %>%
  group_by(ward_no) %>%
  summarize(
    avg_speed_over_limit = mean(over_speed_limit, na.rm = TRUE),
    cameras_nearby = n_distinct(X_id),
    .groups = "drop"
  )

ggplot(ward_speed_analysis, aes(x = cameras_nearby, y = avg_speed_over_limit)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
       x = "Number of Cameras Nearby",
       y = "Average Speed Over Limit")

```

```{r}
#| label: fig-heatmap1
#| fig-cap: Speeding Volume by Ward and Over Speed Limit
#| echo: false

# Aggregate data for heatmap
heatmap_data <- final_filtered_data %>%
  group_by(ward_no, over_speed_limit) %>%
  summarize(total_volume = sum(volume, na.rm = TRUE)) %>%
  ungroup()

# Create the heatmap
ggplot(heatmap_data, aes(x = factor(ward_no), y = over_speed_limit, fill = total_volume)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "lightblue", high = "red", name = "Total Volume") +
  labs(
    x = "Ward Number",
    y = "Over Speed Limit (km/h)"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid = element_blank()
  )
```

# Model {#sec-mymodel}

## Overview

This section outlines the modeling process used to analyze over-speeding behavior based on data from Toronto’s School Safety Zone Watch Your Speed Program and Traffic Cameras datasets. The goal was to predict the extent to which observed speeds exceeded posted limits (over_speed_limit) by evaluating various predictors. Three models were developed and assessed using performance metrics, including RMSE, MAE, and \( R^2 \), to determine the most appropriate model. The final model selection was based on its balance between simplicity, accuracy, and interpretability.

## Model Structure


Common Variables Across All Models:

- Speed Limit (x₁): Posted speed limit at a given location.

- Volume (x₂): Number of vehicles observed in a speed bin.

Model-Specific Variables:

- Model 1: Includes ward-level categorical effects (ward_no) to account for geographic differences in speeding behavior.

- Model 2: Omits ward-level effects to focus solely on speed limits and vehicle volumes.

- Model 3: Adds a camera identifier (Xₓᵢd) to examine the influence of specific camera locations on speeding patterns.

#### Model Formulations

1. Model 1: Full Model with Ward-Level Effects
   \[
   y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \sum_{j=1}^{13} \beta_{3j} \text{ward\_no}_j + \epsilon
   \]

2. Model 2: Excluding Ward-Level Effects
   \[
   y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \epsilon
   \]

3. Model 3: Including Camera Identifiers
   \[
   y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \sum_{j=1}^{13} \beta_{3j} \text{ward\_no}_j + \beta_4 X_{id} + \epsilon
   \]


## Variable Selection and Final Model

The selection process aimed to balance complexity and explanatory power. Ward-level effects were included to capture geographic variations, while Camera Identifiers were tested to evaluate their influence. Redundant variables were excluded to maintain simplicity. Model 1 was selected as the final model because it demonstrated superior performance across key metrics. By including ward-level effects, it effectively captured geographic differences in speeding behavior, making it the most suitable choice.

## Model Validation and Diagnostics

### Performance Metrics

The RMSE for Model 1 was 7.01, indicating that, on average, predictions deviated from observed values by this amount. MAE was 4.77, highlighting its precision in predicting over-speeding behavior. The \( R^2 \) value of 0.176 showed that the model explained 17.6% of the variance in over-speeding behavior, providing a reasonable level of explanatory power for the observed data.

### Residual Diagnostics

Residual diagnostics confirmed the validity of Model 1. The residual standard error of 7.37 aligned closely with the RMSE, reinforcing the model’s accuracy. Residual plots exhibited no systematic patterns, supporting the assumption of linearity. Additionally, homoscedasticity was verified, indicating consistent variance in residuals across predictions.

## Diagnostic Checks and Model Justification

Variance Inflation Factors (VIFs) were calculated to evaluate multicollinearity, with all variables in Model 1 displaying acceptable values below 4. Although Model 3 included Camera Identifiers, this variable was statistically insignificant and did not enhance model performance. Model 1 effectively balanced complexity and accuracy, integrating ward-level effects to provide valuable insights into over-speeding behavior while maintaining interpretability. Consequently, Model 1 was selected as the final model.


# Results {#sec-myresults}


# Discussion {#sec-mydisc}

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

# Weaknesses and next steps {#sec-mylimits}

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}

If you're incorporating feedback to diversify question types and address previous gaps, here’s an improved version of your appendix for Toronto's speeding analysis with a reasonable budget. I'll also ensure it reflects insights from your earlier examples and feedback while incorporating poll aggregation and methodology details.

---

# Idealized Survey & Methodology - $500K Budget {#sec-ideal-surv}

## Overview
This appendix outlines a survey methodology designed to enrich the analysis of excessive speeding near Toronto school zones. With a $500K budget, this approach aims to gather nuanced data from drivers, pedestrians, and community members about speeding behaviors, awareness of enforcement measures, and perceived safety. By integrating observational data with survey insights, this methodology enables robust analysis and informed policy recommendations.

---

## Budget Justification
# Overview

A $500,000 budget is proposed for analyzing speeding trends in Toronto school zones. Based on similar city-wide traffic safety initiatives, such as Vision Zero and speed enforcement studies, this budget is allocated to account for:

Comprehensive sampling: Targeting diverse demographics and road users.

Advanced recruitment and incentives: Ensuring adequate participation.

High-quality data integration: Focused on cleaning, validation, and geospatial analysis.

# Proportionality

Vision Zero allocates $250,000 to $1,000,000 for focused safety measures annually, making $500,000 appropriate for a targeted study [@citytoronto2024].

# Survey Costs

Recruiting diverse participants typically costs $200,000 to $300,000, ensuring robust and representative data [@pew2023].

---

## Sampling Approach
### **Target Groups**
1. **Drivers:**  
   - Key demographic: Ages 18-40, with emphasis on young male drivers.
   - Behavioral patterns: Frequent commuters in school zones.

2. **Pedestrians:**  
   - Parents, school staff, and local residents.

3. **Community Advocates:**  
   - Stakeholders involved in traffic safety initiatives.

### **Sampling Method**
**Multi-Stage Sampling:**
1. **Stratification by Wards:**  
   - Ensure geographic coverage across all Toronto wards with school zones.  
2. **Cluster Sampling:**  
   - Focus on areas near speed cameras and school safety zones.  
3. **Random Sampling:**  
   - Within clusters, randomly select participants for unbiased representation.  

**Sample Size Goal:**  
- **3,000 respondents**: Sufficient to identify trends at the ward level while maintaining a margin of error below ±2%.

---

## Recruitment Strategy
### **Primary Channels**
1. **Online Ads:**  
   - Platforms: TikTok, Instagram, and YouTube.
   - Geo-targeted to school zones and high-traffic areas.
   - Budget Allocation: $150,000.

2. **On-the-Ground Recruitment:**  
   - Flyers distributed in school zones, community centers, and traffic courts.
   - Budget Allocation: $50,000.

3. **Partnerships with Apps:**  
   - Collaboration with navigation tools like Waze to deliver in-app survey prompts.
   - Budget Allocation: $100,000.

4. **Incentives:**  
   - Monetary rewards: $20 gift cards for completion, with a chance to win larger prizes.
   - Budget Allocation: $100,000.

---

## Survey Design

### Diversified Question Types
To address the feedback, the survey incorporates **varied question formats**:

1. **Multiple Choice:**  
   - Example: "What factors most influence your speed in school zones?"
     - Time pressure.
     - Peer behavior.
     - Lack of awareness of speed limits.
     - Others.

2. **Likert Scales:**  
   - Example: "Rate your agreement with: 'Speed cameras make me feel safer in school zones.'"
     - Strongly disagree to strongly agree.

3. **Open-Ended:**  
   - Example: "What other measures would help reduce speeding in school zones?"

4. **Ranking Questions:**  
   - Example: "Rank the following in order of their effectiveness at reducing speeding: speed cameras, visible signage, increased fines, police presence."

5. **Interactive Scenario Questions:**  
   - Example: "If you saw a speed camera sign but no visible camera, how likely are you to still speed? (Very unlikely to very likely)."

---

### Survey Flow
1. **Introduction and Consent:**  
   - Explain the purpose, time required (5-7 minutes), and confidentiality.

2. **Demographics:**  
   - Age, gender, driving habits, and proximity to school zones.

3. **Behavioral Insights:**  
   - Driving patterns, awareness of speed limits, and interaction with enforcement measures.

4. **Perceived Effectiveness:**  
   - Opinions on speed cameras, signage, and enforcement presence.

5. **Safety Concerns:**  
   - Perceptions of safety in school zones and suggested improvements.

---

## Data Validation
1. **Logic Checks:**  
   - Identify inconsistencies (e.g., reporting no awareness of cameras but frequent encounters).  

2. **Cross-Validation:**  
   - Compare survey responses with observational data (e.g., traffic camera footage and speed counts).  

3. **Geospatial Matching:**  
   - Integrate survey responses with geospatial data from speed signs and cameras for location-specific analysis.

---

## Poll Aggregation and Modeling
### **Aggregation Approach**
A **poll-of-polls method** balances survey insights with observational data:
- Weight survey responses by:
  - **Proximity to enforcement measures.**
  - **Frequency of driving in school zones.**
- Integrate responses with speed count data to build predictive models of speeding behavior.

### **Modeling Framework**
- **Dependent Variable:** Likelihood of exceeding speed limits.  
- **Predictors:**  
  - Awareness of enforcement measures.  
  - Demographics (age, gender).  
  - Self-reported speeding behavior.  
  - Proximity to cameras and speed signs.

### **Diagnostics**
- Residual analysis and goodness-of-fit tests to validate model performance.
- Q-Q plots and distribution checks for robustness.

---

## Budget Breakdown

| **Expense**                     | **Cost Estimate (CAD)**  |
|----------------------------------|--------------------------|
| Social Media Recruitment        | $150,000                 |
| In-App Ads and Recruitment      | $100,000                 |
| On-the-Ground Recruitment       | $50,000                  |
| Participant Incentives          | $100,000                 |
| Data Cleaning and Validation    | $75,000                  |
| Survey Design and Implementation| $25,000                  |
| **Total**                       | **$500,000**             |

---

## Appendix Content
1. **Survey Link:**  
   [Insert Google Forms Link Here].

2. **Copy of Survey Questions:**  
   - Include all questions, organized by section.  

3. **Model Diagnostics:**  
   - Residual plots, fit comparisons, and distribution checks.  

---

This improved version addresses the feedback, diversifies question types, and integrates poll aggregation and modeling. Let me know if you’d like refinements!


\newpage


# References


