---
title: "Chasing Speed Demons: Analyzing Toronto’s Speeding Hotspots and Enforcement Gaps”"
subtitle: "My subtitle if needed"
author: 
  - Karen Riani
thanks: "Code and data are available at: https://github.com/karenrni/Analyzing-Torontos-Speeders/."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
toc: true
fig_caption: yes
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(arrow)
library(kableExtra)

final_filtered_data <- read_parquet("../data/analysis_data/analysis_data.parquet")


```
\newpage

# Introduction

Toronto's battle against speeding takes some wild turns—literally and figuratively. A speed camera notorious for issuing tens of thousands of tickets on Parkside Drive, Toronto's most ticketed street for speeding, was cut down less than 24 hours after being reinstalled [@toronto2023; @cbc2023]. While the city struggles to curb speeding, new research by the Canadian Automobile Association (CAA) paints a troubling picture: nearly 70% of Canadians admit to speeding in residential areas, 50% routinely speed on highways, and 20% regularly push well beyond the limit [@jobbernation2023].

The rise of advanced vehicle technology and the adrenaline appeal of street racing exacerbate these issues, with young male drivers (18–25 years) disproportionately represented in this trend. Though rare at **0.9% prevalence**, street racing poses a **five-fold increase in crash risk (OR = 5.23, p < .001)**, even after accounting for other risk factors [@simonsmorton2017]. Despite Ontario’s strict penalties, such as **$10,000 fines** and **30-day license suspensions for excessive speeding**, enforcement alone has not fully addressed these challenges [@trafficparalegal2024]. Recent headlines, such as a driver clocked at **102 km/h in a 50 km/h school zone** and a Toronto speed camera being destroyed less than 24 hours after reinstallation, underscore the disconnect between enforcement measures and public behavior [@citynews2024; @cbc2023].

This paper focuses on understanding **over_speed_limit**, the amount by which speeds in each observed speed bin exceed the posted speed limit. This dependent variable is calculated as the difference between the lower bound of the observed speed bin and the speed limit, ensuring a straightforward measure of speeding severity. By quantifying how far drivers exceed the limit, over_speed_limit allows for identifying patterns of high-risk speeding behaviour. Using open data from Toronto's School Safety Zone Watch Your Speed Program, Watch Your Speed Detailed Counts, and Traffic Camera datasets, including vehicle counts (volume) in each speed bin, speed limits, and ward-level identifiers, this study investigates how traffic patterns, enforcement mechanisms, and geographic factors contribute to variations in speeding behaviour across the city.

To address this, the study employs multi-linear regression models to examine the relationship between excess speed and predictors such as traffic volume, speed limits, and ward characteristics. Results indicate that higher traffic volume reduces excess speed by **0.12 km/h per additional vehicle**, while speed limits positively influence speeding by **0.13 km/h per unit increase**. Wards exhibit substantial variability, with some, such as Ward 4, showing significant decreases in speeding. However, the impact of individual speed cameras was negligible, suggesting limitations in the data and methodology for evaluating camera-specific effects.

The rest of this paper is structured as follows:  @sec-mydatasection presents the data sources and methodology, @sec-mymodel presents the forecasting model, then  @sec-myresults followed by  @sec-mydisc, which discusses the results and their implications.  @sec-mylimits concludes with a discussion of the limitations of the study and suggestions for future research, followed by Appendix @sec-ideal-surv with a budgeted idealized survey and methodology.



# Data {#sec-mydatasection}

## Overview
The data for this analysis is sourced from Open Data Toronto and comprises three datasets: School Safety Zone Watch Your Speed Program – Locations [@schoolzonelocations], School Safety Zone Watch Your Speed Program – Detailed Speed Counts [@schoolzonespeeds], and the Traffic Camera dataset  [@trafficcameras]. These datasets provide detailed insights into speeding behavior, traffic enforcement mechanisms, and geographic characteristics within Toronto. All data analysis was performed using R [@citeR], employing a variety of packages to ensure robust and reproducible workflows.

## Packages Used
The analysis utilized R [@citeR] with the following packages: `opendatatoronto` [@opendatatoronto], `tidyverse` [@tidyverse], `janitor` [@janitor], `arrow` [@arrow], `readr` [@readr], `sf` [@sfpackage], `testthat` [@testthat], `ggplot2` [@ggplot2_wickham_2016], `corrplot` [@corrplot], `tidymodels` [@tidymodels], `kableExtra` [@kableExtra] and `rstanarm` [@rstanarm].

## Measurement and Limitations

The datasets from Open Data Toronto serve as the foundation for analyzing speeding behavior in Toronto. Each variable is derived from real-world phenomena and represents a specific aspect of traffic patterns or enforcement mechanisms:

1. **Over Speed Limit**: This key dependent variable quantifies the extent to which drivers exceed posted speed limits. It is derived by calculating the difference between the midpoint of the observed speed bin (e.g., `[45,50)` translates to a midpoint of 47.5 km/h) and the posted speed limit. This method provides a nuanced measure of speeding severity, distinguishing between minor infractions and extreme violations.

2. **No Camera in Radius**: This binary variable was constructed based on spatial joins between speed observation data and camera locations. If a given location fell outside the defined radius of nearby cameras, it was flagged as `TRUE`. This captures the absence of enforcement presence and allows for an analysis of its influence on speeding behavior.

3. **Camera Density**: To represent enforcement intensity across wards, the number of cameras was aggregated per ward. This variable offers insight into how concentrated enforcement might correlate with traffic patterns or speeding violations.

4. **Traffic Volume**: This variable directly records the number of vehicles observed at a specific location within a given speed bin and time interval. It is included in the datasets as raw counts, reflecting real-time traffic flow.

5. **Speed Limit**: This variable is a direct measure of the posted speed regulations at specific locations. Data entries were validated against known regulations to ensure accuracy.

6. **Ward Number**: A categorical representation of Toronto’s geographic divisions, this variable contextualizes speeding behavior within specific zones. Each ward entry corresponds to a specific administrative boundary, linking observed behaviors to broader urban planning and enforcement efforts.

### Data Transformation and Limitations
The process of moving from real-world observations to dataset entries involves several key transformations:

- **Spatial Joins**: Camera locations (latitude and longitude) were mapped against speed observation points to identify enforcement presence.

- **Calculated Variables**: Metrics like over speed limit and camera density were derived from raw data, enabling a more analytical exploration of speeding patterns.

Despite these transformations, limitations exist. Speed bin midpoints assume a uniform speed distribution within each bin, which may not reflect reality. Additionally, camera placements are biased toward high-traffic or high-risk areas, potentially underrepresenting quieter zones. These factors necessitate caution when interpreting results, as the dataset captures a snapshot rather than a complete picture of traffic behavior.

## Variables of Interest
The dataset includes several critical variables relevant to speeding behavior:

- **Sign ID and Camera ID (X_id)**: Unique identifiers for speed cameras and their locations, enabling the association of speeding patterns with enforcement points.
- **Longitude and Latitude**: Geographic coordinates capturing the location of observed speeding behavior.
- **Speed Limit**: Posted speed limits for each location, ranging from 30 km/h to 50 km/h, with an average of 38.24 km/h.
- **Volume**: The number of vehicles observed in a given speed bin. The median volume is 13 vehicles, but counts range widely, with a maximum of 209 vehicles.
- **Speed Bin**: Recorded ranges of observed speeds, such as `[45,50)`, providing context for speed categories.
- **Ward Number**: Geographic zones represented by categorical identifiers. Ward 10 had the highest representation in the data (28.8% of observations), while Ward 19 had significantly fewer observations.
- **Over Speed Limit**: A calculated variable representing the extent to which observed speeds exceed posted limits. This variable allows for a nuanced exploration of speeding severity, with a mean value of 3.91 km/h and a maximum of 70 km/h.

## Descriptive Statistics
Descriptive statistics in [@tbl-summary] highlight critical patterns within the data:

- The **mean over speed limit** is 3.91 km/h, with extreme violations reaching up to 70 km/h.

- The **median speed bin midpoint** is 30 km/h, while the mean traffic volume is 23.35 vehicles.

- Geographic variables such as **longitude** and **latitude** center around Toronto’s urban core.


```{r}
#| label: tbl-summary
#| fig-cap: Summary of Joined Analysis Data
#| echo: false

# Prepare summary data
summary_data <- data.frame(
  Variable = c("sign_id", "X_id", "longitude", "latitude", 
               "speed_limit", "volume", "speed_bin_lower", "over_speed_limit"),
  Min = c(23, 11, -79.58, 43.64, 30, 1, 5, 0),
  "1st Qu." = c(667, 146, -79.40, 43.65, 40, 4, 15, 0),
  Median = c(950, 298, -79.36, 43.65, 40, 13, 30, 0),
  Mean = c(1105, 247.1, -79.36, 43.68, 38.24, 23.35, 30.23, 3.91),
  "3rd Qu." = c(978, 362, -79.33, 43.71, 40, 35, 40, 5),
  Max = c(2622, 423, -79.19, 43.79, 50, 209, 100, 70)
)

# Create a formatted table
summary_data %>%
  kbl(caption = "Summary Statistics for the Final Filtered Data") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), 
                full_width = FALSE, 
                position = "center") %>%
  column_spec(1, bold = TRUE, width = "10em") %>%
  row_spec(0, bold = TRUE)



```

# Model {#sec-mymodel}

# Results {#sec-myresults}

# Discussion {#sec-mydisc}

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

# Weaknesses and next steps {#sec-mylimits}

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}

If you're incorporating feedback to diversify question types and address previous gaps, here’s an improved version of your appendix for Toronto's speeding analysis with a reasonable budget. I'll also ensure it reflects insights from your earlier examples and feedback while incorporating poll aggregation and methodology details.

---

# Idealized Survey & Methodology - $500K Budget {#sec-ideal-surv}

## Overview
This appendix outlines a survey methodology designed to enrich the analysis of excessive speeding near Toronto school zones. With a $500K budget, this approach aims to gather nuanced data from drivers, pedestrians, and community members about speeding behaviors, awareness of enforcement measures, and perceived safety. By integrating observational data with survey insights, this methodology enables robust analysis and informed policy recommendations.

---

## Budget Justification
# Overview

A $500,000 budget is proposed for analyzing speeding trends in Toronto school zones. Based on similar city-wide traffic safety initiatives, such as Vision Zero and speed enforcement studies, this budget is allocated to account for:

Comprehensive sampling: Targeting diverse demographics and road users.

Advanced recruitment and incentives: Ensuring adequate participation.

High-quality data integration: Focused on cleaning, validation, and geospatial analysis.

# Proportionality

Vision Zero allocates $250,000 to $1,000,000 for focused safety measures annually, making $500,000 appropriate for a targeted study [@citytoronto2024].

# Survey Costs

Recruiting diverse participants typically costs $200,000 to $300,000, ensuring robust and representative data [@pew2023].

---

## Sampling Approach
### **Target Groups**
1. **Drivers:**  
   - Key demographic: Ages 18-40, with emphasis on young male drivers.
   - Behavioral patterns: Frequent commuters in school zones.

2. **Pedestrians:**  
   - Parents, school staff, and local residents.

3. **Community Advocates:**  
   - Stakeholders involved in traffic safety initiatives.

### **Sampling Method**
**Multi-Stage Sampling:**
1. **Stratification by Wards:**  
   - Ensure geographic coverage across all Toronto wards with school zones.  
2. **Cluster Sampling:**  
   - Focus on areas near speed cameras and school safety zones.  
3. **Random Sampling:**  
   - Within clusters, randomly select participants for unbiased representation.  

**Sample Size Goal:**  
- **3,000 respondents**: Sufficient to identify trends at the ward level while maintaining a margin of error below ±2%.

---

## Recruitment Strategy
### **Primary Channels**
1. **Online Ads:**  
   - Platforms: TikTok, Instagram, and YouTube.
   - Geo-targeted to school zones and high-traffic areas.
   - Budget Allocation: $150,000.

2. **On-the-Ground Recruitment:**  
   - Flyers distributed in school zones, community centers, and traffic courts.
   - Budget Allocation: $50,000.

3. **Partnerships with Apps:**  
   - Collaboration with navigation tools like Waze to deliver in-app survey prompts.
   - Budget Allocation: $100,000.

4. **Incentives:**  
   - Monetary rewards: $20 gift cards for completion, with a chance to win larger prizes.
   - Budget Allocation: $100,000.

---

## Survey Design

### Diversified Question Types
To address the feedback, the survey incorporates **varied question formats**:

1. **Multiple Choice:**  
   - Example: "What factors most influence your speed in school zones?"
     - Time pressure.
     - Peer behavior.
     - Lack of awareness of speed limits.
     - Others.

2. **Likert Scales:**  
   - Example: "Rate your agreement with: 'Speed cameras make me feel safer in school zones.'"
     - Strongly disagree to strongly agree.

3. **Open-Ended:**  
   - Example: "What other measures would help reduce speeding in school zones?"

4. **Ranking Questions:**  
   - Example: "Rank the following in order of their effectiveness at reducing speeding: speed cameras, visible signage, increased fines, police presence."

5. **Interactive Scenario Questions:**  
   - Example: "If you saw a speed camera sign but no visible camera, how likely are you to still speed? (Very unlikely to very likely)."

---

### Survey Flow
1. **Introduction and Consent:**  
   - Explain the purpose, time required (5-7 minutes), and confidentiality.

2. **Demographics:**  
   - Age, gender, driving habits, and proximity to school zones.

3. **Behavioral Insights:**  
   - Driving patterns, awareness of speed limits, and interaction with enforcement measures.

4. **Perceived Effectiveness:**  
   - Opinions on speed cameras, signage, and enforcement presence.

5. **Safety Concerns:**  
   - Perceptions of safety in school zones and suggested improvements.

---

## Data Validation
1. **Logic Checks:**  
   - Identify inconsistencies (e.g., reporting no awareness of cameras but frequent encounters).  

2. **Cross-Validation:**  
   - Compare survey responses with observational data (e.g., traffic camera footage and speed counts).  

3. **Geospatial Matching:**  
   - Integrate survey responses with geospatial data from speed signs and cameras for location-specific analysis.

---

## Poll Aggregation and Modeling
### **Aggregation Approach**
A **poll-of-polls method** balances survey insights with observational data:
- Weight survey responses by:
  - **Proximity to enforcement measures.**
  - **Frequency of driving in school zones.**
- Integrate responses with speed count data to build predictive models of speeding behavior.

### **Modeling Framework**
- **Dependent Variable:** Likelihood of exceeding speed limits.  
- **Predictors:**  
  - Awareness of enforcement measures.  
  - Demographics (age, gender).  
  - Self-reported speeding behavior.  
  - Proximity to cameras and speed signs.

### **Diagnostics**
- Residual analysis and goodness-of-fit tests to validate model performance.
- Q-Q plots and distribution checks for robustness.

---

## Budget Breakdown

| **Expense**                     | **Cost Estimate (CAD)**  |
|----------------------------------|--------------------------|
| Social Media Recruitment        | $150,000                 |
| In-App Ads and Recruitment      | $100,000                 |
| On-the-Ground Recruitment       | $50,000                  |
| Participant Incentives          | $100,000                 |
| Data Cleaning and Validation    | $75,000                  |
| Survey Design and Implementation| $25,000                  |
| **Total**                       | **$500,000**             |

---

## Appendix Content
1. **Survey Link:**  
   [Insert Google Forms Link Here].

2. **Copy of Survey Questions:**  
   - Include all questions, organized by section.  

3. **Model Diagnostics:**  
   - Residual plots, fit comparisons, and distribution checks.  

---

This improved version addresses the feedback, diversifies question types, and integrates poll aggregation and modeling. Let me know if you’d like refinements!


\newpage


# References


